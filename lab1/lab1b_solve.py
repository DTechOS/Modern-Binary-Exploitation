# result_EAX = strcmp((char *)&enc_string,"Congratulations!"); strcmp, compares the result of our imput after 
#being passed through the xor arithmetic
# we need to find a key that when xored with the encrypted string = Congratulations! 
# 0x51 = Q, first character of the encrypted string, C = first character of Congratulations!
               
key = ord('C') ^ 0x51 # XOR EAX,EDX
print("Xor key: {}".format(key))                        

# in test() the contant 0x1337d00d is moved onto the stack, then passed to decrypt()
#   a string with input - 0x1337d00d
password = 0x1337d00d - key
print("Challenge password: {}".format(password))

# XOR'ing the encrypted string with the key 18 returns Congratulations!
xor_key = 18
s1 = "Q}|u`sfg~sf{}|a3"
for i in range(len(s1)):
    res = chr(ord(s1[i]) ^ xor_key) 
    print(res, end='')
